#!/usr/bin/env python

import argparse

from PIL import Image, ImageFont, ImageDraw
from fonts.ttf import AmaticSCBold

from inky import InkyPHAT

print("""Inky pHAT: Hello... my name is:

Use Inky pHAT as a personalised name badge!

""")

#inkyphat.set_rotation(180)

parser = argparse.ArgumentParser()
parser.add_argument('--colour', '-c', type=str, required=True, choices=["red", "black", "yellow"], help="ePaper display colour")
parser.add_argument('--name', '-n', type=str, required=True, help="Your name")
args = parser.parse_args()

colour = args.colour

inky_display = InkyPHAT(colour)

# Show the backdrop image

#inky_display.set_border(inky_display.RED)
img = Image.new("P", (inky_display.WIDTH, inky_display.HEIGHT))
draw = ImageDraw.Draw(img)

# Add the text

intuitive_font = ImageFont.truetype("/home/pi/fonts/intuitive.ttf", 38)
hanken_bold_font = ImageFont.truetype("/home/pi/fonts/HankenGrotesk-Bold.otf", 32)
hanken_regular_font = ImageFont.truetype("/home/pi/fonts/HankenGrotesk-Regular.otf", 18)

name = args.name

#w, h = font.getsize(name)

# Center the text and align it with the name strip

y_top = int(inky_display.HEIGHT * (6.0 / 10.0))
y_bottom = y_top + int(inky_display.HEIGHT / 5.0)

#draw.text((x, y), name, inky_display.BLACK, font=font)

print(y_top, y_bottom)

for y in range(0, y_top):
    for x in range(0, inky_display.width):
        inky_display.set_pixel(x, y, inky_display.RED)

for y in range(y_top, y_bottom):
    for x in range(0, inky_display.width):
        inky_display.set_pixel(x, y, inky_display.WHITE)

for y in range(y_bottom, inky_display.HEIGHT):
    for x in range(0, inky_display.width):
        inky_display.set_pixel(x, y, inky_display.RED)

inky_display.set_image(img)
inky_display.show()
